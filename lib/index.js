"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var posiitons_tree_1 = __importDefault(require("./posiitons-tree"));
function canvasTree(canvas, tree) {
    var offsetWidth = canvas.offsetWidth, offsetHeight = canvas.offsetHeight;
    var ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, offsetWidth, offsetHeight);
    var fontSize = offsetWidth * 0.03;
    ctx.font = fontSize + "px black";
    var positionsTree = new posiitons_tree_1.default(tree, canvas);
    drawPoint(ctx, positionsTree.root);
}
exports.default = canvasTree;
function drawPoint(ctx, point) {
    var x = point.x, y = point.y, radius = point.radius, left = point.left, right = point.right, value = point.value;
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, Math.PI * 2);
    var fillColor = ctx.fillStyle;
    var strokeColor = ctx.strokeStyle;
    if (point.node.isRed || point.node.isBlack) {
        ctx.strokeStyle = "#fff";
    }
    if (point.node.isRed) {
        ctx.fillStyle = '#FC0D1C';
        ctx.fill();
    }
    if (point.node.isBlack) {
        ctx.fillStyle = '#414141';
        ctx.fill();
    }
    ctx.stroke();
    ctx.closePath();
    ctx.fillStyle = fillColor;
    ctx.strokeStyle = strokeColor;
    var text = value;
    var measure = ctx.measureText(text);
    ctx.strokeText(text, x - measure.width / 2, y + 4, 20);
    if (left) {
        drawPoint(ctx, left);
        var angle = calculateAngle(left, point);
        drawArrow(ctx, x + Math.cos(angle) * radius, y + Math.sin(angle) * radius, left.x - Math.cos(angle) * left.radius, left.y - Math.sin(angle) * left.radius);
    }
    if (right) {
        drawPoint(ctx, right);
        var angle = calculateAngle(right, point);
        drawArrow(ctx, x + Math.cos(angle) * radius, y + Math.sin(angle) * radius, right.x - Math.cos(angle) * right.radius, right.y - Math.sin(angle) * right.radius);
    }
}
function calculateAngle(node1, node2) {
    return Math.atan2(node1.y - node2.y, node1.x - node2.x);
}
function drawArrow(ctx, fromX, fromY, toX, toY) {
    ctx.beginPath();
    var headlen = 5;
    var angle = Math.atan2(toY - fromY, toX - fromX);
    ctx.moveTo(fromX, fromY);
    ctx.lineTo(toX, toY);
    ctx.lineTo(toX - headlen * Math.cos(angle - Math.PI / 6), toY - headlen * Math.sin(angle - Math.PI / 6));
    ctx.moveTo(toX, toY);
    ctx.lineTo(toX - headlen * Math.cos(angle + Math.PI / 6), toY - headlen * Math.sin(angle + Math.PI / 6));
    ctx.stroke();
    ctx.closePath();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSxvRUFBNEM7QUFFNUMsb0JBQW1DLE1BQXlCLEVBQUUsSUFBSTtJQUN6RCxJQUFBLGdDQUFXLEVBQUUsa0NBQVksQ0FBVztJQUMzQyxJQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDL0MsSUFBTSxRQUFRLEdBQUcsV0FBVyxHQUFHLElBQUksQ0FBQztJQUNwQyxHQUFHLENBQUMsSUFBSSxHQUFNLFFBQVEsYUFBVSxDQUFDO0lBQ2pDLElBQU0sYUFBYSxHQUFHLElBQUksd0JBQWEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDdEQsU0FBUyxDQUFDLEdBQUcsRUFBRSxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDckMsQ0FBQztBQVJELDZCQVFDO0FBRUQsbUJBQW1CLEdBQTZCLEVBQUUsS0FBWTtJQUNyRCxJQUFBLFdBQUMsRUFBQyxXQUFDLEVBQUMscUJBQU0sRUFBQyxpQkFBSSxFQUFDLG1CQUFLLEVBQUMsbUJBQUssQ0FBVTtJQUM1QyxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDaEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUN0QyxJQUFNLFNBQVMsR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDO0lBQ2hDLElBQU0sV0FBVyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUM7SUFDcEMsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFD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